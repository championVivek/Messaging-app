(this["webpackJsonpmessaging-frontend"]=this["webpackJsonpmessaging-frontend"]||[]).push([[0],{142:function(e,t,a){},143:function(e,t,a){"use strict";a.r(t);var n=a(2),s=a(0),r=a.n(s),c=a(26),o=a.n(c),i=(a(89),a(17)),j=a.n(i),l=a(25),u=a(8),d=a(149),b=a(151),m=a(6),O=Object(s.createContext)({});function p(){var e=Object(m.f)(),t=Object(s.useContext)(O),a=t.userData,r=t.setUserData;return Object(n.jsxs)(d.a,{collapseOnSelect:!0,expand:"lg",bg:"dark",variant:"dark",sticky:!0,children:[Object(n.jsx)(d.a.Brand,{children:"MESSAGING"}),Object(n.jsx)(d.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),Object(n.jsx)(d.a.Collapse,{id:"responsive-navbar-nav",className:"justify-content-end",children:a.user?Object(n.jsx)(b.a,{children:Object(n.jsx)(b.a.Link,{onClick:function(){r({token:void 0,user:void 0,displayname:void 0}),localStorage.setItem("auth-token",""),e.push("/")},children:"LogOut"})}):Object(n.jsx)(b.a,{})})]})}var h=a(22),x=a(145),f=a(150),g=a(146);function v(e){return Object(n.jsx)("div",{className:"alert alert-danger",children:e.message})}var y=a(80),k=a.n(y).a.create({baseURL:""});function C(){var e=Object(s.useState)(),t=Object(u.a)(e,2),a=t[0],r=t[1],c=Object(s.useState)(),o=Object(u.a)(c,2),i=o[0],d=o[1],b=Object(s.useContext)(O).setUserData,p=Object(s.useState)(),y=Object(u.a)(p,2),C=y[0],S=y[1],w=Object(m.f)(),N=function(){var e=Object(l.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,k.post("/login",{email:a,password:i});case 4:n=e.sent,b({token:n.data.token,user:n.data.user}),localStorage.setItem("auth-token",n.data.token),w.push("/messaging"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),e.t0.response.data.msg&&S(e.t0.response.data.msg);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(n.jsx)(x.a,{style:{display:"flex",justifyContent:"center",paddingTop:"5rem"},children:Object(n.jsxs)(f.a,{style:{width:"50rem"},onSubmit:N,children:[Object(n.jsx)(f.a.Label,{style:{fontSize:"3rem"},children:"Login"}),C&&Object(n.jsx)(v,{message:C}),Object(n.jsxs)(f.a.Group,{controlId:"formGroupEmail",children:[Object(n.jsx)(f.a.Label,{children:"Email"}),Object(n.jsx)(f.a.Control,{type:"email",placeholder:"Enter email",onChange:function(e){return r(e.target.value)}})]}),Object(n.jsxs)(f.a.Group,{controlId:"formGroupPassword",children:[Object(n.jsx)(f.a.Label,{children:"Password"}),Object(n.jsx)(f.a.Control,{type:"password",placeholder:"Password",onChange:function(e){return d(e.target.value)}})]}),Object(n.jsx)(g.a,{variant:"success",type:"submit",children:"Login"})," ",Object(n.jsx)(g.a,{variant:"secondary",type:"submit",as:h.b,to:"/signup",children:"Create an account"})]})})}var S=a(147),w=a(81);function N(){var e=Object(s.useState)(),t=Object(u.a)(e,2),a=t[0],r=t[1],c=Object(s.useState)(),o=Object(u.a)(c,2),i=o[0],d=o[1],b=Object(s.useState)(),O=Object(u.a)(b,2),p=O[0],y=O[1],C=Object(s.useState)(),N=Object(u.a)(C,2),L=N[0],E=N[1],G=Object(s.useState)(),D=Object(u.a)(G,2),I=D[0],B=D[1],P=Object(m.f)(),T=function(){var e=Object(l.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,k.post("/signup",{name:a,gender:L,email:i,password:p});case 4:P.push("/login"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),e.t0.response.data.msg&&B(e.t0.response.data.msg);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}();return Object(n.jsx)(x.a,{style:{display:"flex",justifyContent:"center",paddingTop:"2rem",paddingBottom:"8%"},children:Object(n.jsxs)(f.a,{style:{width:"50rem"},onSubmit:T,children:[Object(n.jsx)(f.a.Label,{style:{fontSize:"3rem"},children:"Signup"}),I&&Object(n.jsx)(v,{message:I}),Object(n.jsxs)(f.a.Group,{controlId:"formGroupName",children:[Object(n.jsx)(f.a.Label,{children:"Name"}),Object(n.jsx)(f.a.Control,{type:"text",placeholder:"Enter name",onChange:function(e){return r(e.target.value)}})]}),Object(n.jsx)("fieldset",{children:Object(n.jsxs)(f.a.Group,{as:S.a,children:[Object(n.jsx)(f.a.Label,{as:"legend",column:!0,sm:2,children:"Gender"}),Object(n.jsxs)(w.a,{sm:10,children:[Object(n.jsx)(f.a.Check,{type:"radio",label:"Male",name:"formHorizontalRadios",id:"formHorizontalRadios1",onChange:function(e){return E("Male")}}),Object(n.jsx)(f.a.Check,{type:"radio",label:"Female",name:"formHorizontalRadios",id:"formHorizontalRadios2",onChange:function(e){return E("Female")}})]})]})}),Object(n.jsxs)(f.a.Group,{controlId:"formGroupEmail",children:[Object(n.jsx)(f.a.Label,{children:"Email"}),Object(n.jsx)(f.a.Control,{type:"text",placeholder:"Enter email",onChange:function(e){return d(e.target.value)}})]}),Object(n.jsxs)(f.a.Group,{controlId:"formGroupPassword",children:[Object(n.jsx)(f.a.Label,{children:"Password"}),Object(n.jsx)(f.a.Control,{type:"password",placeholder:"Password",onChange:function(e){return y(e.target.value)}})]}),Object(n.jsx)(g.a,{variant:"success",type:"submit",children:"Signup"})," ",Object(n.jsx)(g.a,{variant:"secondary",type:"submit",as:h.b,to:"/login",children:"Already have an account?"})]})})}var L=a(83),E=a(51),G=a.n(E),D=a(148),I=a(82),B=a.n(I)()("");a(142);function P(){var e=Object(s.useState)([]),t=Object(u.a)(e,2),a=t[0],r=t[1],c=Object(s.useState)(""),o=Object(u.a)(c,2),i=o[0],j=o[1],l=Object(s.useRef)(null),d=Object(s.useContext)(O).userData;Object(s.useEffect)((function(){return d.user&&l&&l.current.addEventListener("DOMNodeInserted",(function(e){var t=e.currentTarget;t.scroll({top:t.scrollHeight,behavior:"smooth"})})),B.on("chat_rcvd",(function(e){r([].concat(Object(L.a)(a),[{message:e.msg,username:e.user,time:e.time,id:e.id}]))})),function(){return B.off("chat_rcvd")}}),[a,d.user]);return Object(n.jsx)("div",{children:void 0===d.user?Object(n.jsx)(C,{}):Object(n.jsxs)("div",{className:"container",children:[Object(n.jsx)("div",{className:"chatBox",ref:l,children:Object(n.jsx)("div",{children:a.map((function(e,t){return e.username===d.user.displayname?Object(n.jsx)("div",{className:"messageContainer justifyEnd",children:Object(n.jsxs)("div",{className:"messageBox backgroundBlue",children:[Object(n.jsx)("p",{className:"messageText colorWhite",children:G.a.emojify(e.message)}),Object(n.jsx)("br",{}),Object(n.jsx)("p",{className:"time",children:e.time})]})},t):Object(n.jsx)("div",{className:"messageContainer justifyStart",children:Object(n.jsxs)("div",{className:"messageBox backgroundLight",children:[Object(n.jsx)("p",{className:"sentText p1-10",children:e.username}),Object(n.jsx)("p",{className:"messageText colorDark",children:G.a.emojify(e.message)}),Object(n.jsx)("br",{}),Object(n.jsx)("p",{className:"time",children:e.time})]})},t)}))})}),Object(n.jsx)("div",{className:"form",children:Object(n.jsx)(f.a,{onSubmit:function(e){if(e.preventDefault(),""!==i){var t=new Date,a=t.getHours()+":"+t.getMinutes();B.emit("chats",{msg:i,username:d.user.displayname,time:a}),j("")}},children:Object(n.jsxs)(D.a,{className:"mb-3",children:[Object(n.jsx)(f.a.Control,{type:"text",placeholder:"Enter message",value:i,onChange:function(e){return j(e.target.value)}}),Object(n.jsx)(D.a.Append,{children:Object(n.jsx)(g.a,{type:"submit",children:"Send"})})]})})})]})})}function T(){var e=Object(s.useContext)(O).userData;return Object(n.jsx)("div",{children:e.user?Object(n.jsx)(P,{}):Object(n.jsx)(C,{})})}function z(){var e=Object(s.useState)({token:void 0,user:void 0}),t=Object(u.a)(e,2),a=t[0],c=t[1];return Object(s.useEffect)((function(){(function(){var e=Object(l.a)(j.a.mark((function e(){var t,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(t=localStorage.getItem("auth-token"))&&(localStorage.setItem("auth-token",""),t=""),e.next=4,k.post("/tokenisValid",null,{headers:{"x-auth-token":t}});case 4:if(!e.sent.data){e.next=10;break}return e.next=8,k.get("/",{headers:{"x-auth-token":t}});case 8:a=e.sent,c({token:t,user:a.data});case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(n.jsx)(h.a,{children:Object(n.jsx)(r.a.Fragment,{children:Object(n.jsxs)(O.Provider,{value:{userData:a,setUserData:c},children:[Object(n.jsx)(p,{}),Object(n.jsxs)(m.c,{children:[Object(n.jsx)(m.a,{path:"/messaging",component:P}),Object(n.jsx)(m.a,{path:"/signup",component:N}),Object(n.jsx)(m.a,{path:"/login",component:C}),Object(n.jsx)(m.a,{path:"/",component:T})]})]})})})}o.a.render(Object(n.jsx)(z,{}),document.getElementById("root"))}},[[143,1,2]]]);
//# sourceMappingURL=main.f16f82c9.chunk.js.map